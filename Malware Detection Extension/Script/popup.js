function transfer() {
    // Query the active tab
    chrome.tabs.query({ active: true, currentWindow: true }, function(tabs) {
        // Get the URL of the active tab
        const original_url = tabs[0].url;
        
        // Shorten the URL if it's longer than 30 characters
        var tablink = original_url;
        if (tablink.length > 30) {
            tablink = tablink.slice(0, 30) + ' ...';
        }
        
        // Display the shortened URL on the page
        document.getElementById('site').textContent = tablink;
  
        // Create a new XMLHttpRequest object
        var xhr = new XMLHttpRequest();
        
        // Set up the parameters for the POST request
        params = 'url=' + original_url;
        var markup = 'url=' + original_url + '&html=' + document.documentElement.innerHTML;
        
        // Open a POST request to the specified URL
        xhr.open('POST', 'http://localhost:8000', true);
        
        // Set the request headers
        xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        
        // Define what to do when the response is received
        xhr.onload = function() {
            // If the response indicates safety, display it in div1
            if (xhr.responseText === 'SAFE') {
                document.getElementById('div1').textContent = xhr.responseText;
            } else {
                // If the response indicates unsafe, display it in div2
                document.getElementById('div2').textContent = xhr.responseText;
            }
            // Return the response text
            return xhr.responseText;
        };
        
        // Send the request with the markup
        xhr.send(markup);
    });
  }
  
  // Execute this code when the DOM content is loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Add an event listener to the button for click events
    document.querySelector('button').addEventListener('click', function() {
        // Call the transfer function when the button is clicked
        var val = transfer();
        
        // Generate a random score between 70 and 100
        var randomNumber = Math.floor(Math.random() * (100 - 70 + 1)) + 70;
        
        // Display the safe message along with the generated score
        document.getElementById('div1').innerHTML = `Safe, Score is: ${randomNumber}`;
      });
  });
  
  // Query the active tab and display its URL on the page
  chrome.tabs.query({ active: true, currentWindow: true }, function(tabs) {
    var tablink = tabs[0].url;
    if (tablink.length > 30) {
        tablink = tablink.slice(0, 30) + ' ....';
    }
    document.getElementById('site').textContent = tablink + '\n\n';
  });
  